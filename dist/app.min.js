function o(o){return document.getElementById(o)}function l(o=6){return Math.random().toString(16).substr(-o)}const e="new-game",r="state-reset",c="start-game",a="reset-level",n="level-selected",s="show-score";function t(l,e){let r=new CustomEvent(l,{detail:e});o("app").dispatchEvent(r)}function u(l,e){o("app").addEventListener(l,e,!1)}document.querySelector("body").classList.add("lang-nl");const d={modal:{newGame:{body:"Weet je zeker dat je een nieuw spel wil beginnen?"}},label:{cancel:"Annuleren",ok:"OK",newGame:"Nieuw spel",bonus:"bonus",columns:"A-O",stars:"Sterren",totals:"Totaal",jokers:"Jokers"},notification:{landscapeMode:"Draai het scherm horizontaal om te beginnen.",selectLevel:"Selecteer een level."}};function i(o,l={},e){let r=document.createElement(o);return Object.keys(l).forEach((function(o){r[o]=l[o]})),e&&e.append(r),r}function g(o){let l=i("div");return l.innerHTML=o,l.firstElementChild}function v(){const l="newGame";o(l)||(b({id:"newGameModal",message:d.modal.newGame.body,buttons:{cancel:{id:"newGameModalCancel",label:d.label.cancel,callback:()=>(m("newGameModal"),!1)},ok:{id:"newGameModalConfirm",label:d.label.ok,callback:()=>(m("newGameModal"),t(e),!1)}}}),o("grid").append(function(o={}){const l={callback:()=>!1,className:"button",...o};let e=g(`<a>${l.label}</a>`);return l.callback&&"function"==typeof l.callback&&e.addEventListener("click",l.callback,!1),l.className&&(e.className=l.className),l.id&&(e.id=l.id),e}({callback(o){o.preventDefault(),m("newGameModal")},label:d.label.newGame,className:"new-game",id:l})))}function b(e){let r={...{id:"modal-"+l(),message:"No modal message is set.",buttons:!1,appendTo:"#app",visible:!1},...e};!0===r.buttons&&(r.buttons={cancel:{id:r.id+"-cancel",label:d.label.cancel},ok:{id:r.id+"-ok",label:d.label.ok}});let c=g(`\n        <div class="modal-overlay${r.visible?" show":""}" id="${r.id}">\n            <div class="modal-container">\n                ${r.title?`\n                <div class="modal-title">\n                    <h2>${r.title}</h2>\n                </div>\n                `:""}\n                ${r.body&&!r.message?r.body:`\n                <div class="modal-body">\n                    <p>${r.message}</p>\n                </div>\n                `}\n                ${r.buttons?`\n                <div class="modal-button-bar">\n                    ${r.buttons.cancel?`<a href="#" id="${r.buttons.cancel.id}" class="button button-cancel">${r.buttons.cancel.label}</a>`:""}\n                    ${r.buttons.ok?`<a href="#" id="${r.buttons.ok.id}" class="button button-confirm">${r.buttons.ok.label}</a>`:""}\n                </div>\n                `:""}\n            </div>\n        </div>\n    `);return r.buttons.cancel&&"function"==typeof r.buttons.cancel.callback&&c.querySelector("#"+r.buttons.cancel.id).addEventListener("click",r.buttons.cancel.callback,!1),r.buttons.ok&&"function"==typeof r.buttons.ok.callback&&c.querySelector("#"+r.buttons.ok.id).addEventListener("click",r.buttons.ok.callback,!1),o("app").append(c),c}function m(l){o(l).classList.toggle("show")}const y=[{column:"A",score:[{value:5},{value:3}],grid:[{color:"green"},{color:"orange"},{color:"blue",star:!0},{color:"blue"},{color:"red"},{color:"red"},{color:"yellow"}]},{column:"B",score:[{value:3},{value:2}],grid:[{color:"green"},{color:"green"},{color:"green"},{color:"red"},{color:"orange"},{color:"blue",star:!0},{color:"yellow"}]},{column:"C",score:[{value:3},{value:2}],grid:[{color:"green"},{color:"yellow",star:!0},{color:"red"},{color:"red"},{color:"orange"},{color:"blue"},{color:"blue"}]},{column:"D",score:[{value:3},{value:2}],grid:[{color:"yellow"},{color:"green"},{color:"green"},{color:"green"},{color:"orange"},{color:"red",star:!0},{color:"blue"}]},{column:"E",score:[{value:2},{value:1}],grid:[{color:"yellow"},{color:"yellow",star:!0},{color:"green"},{color:"orange"},{color:"orange"},{color:"red"},{color:"blue"}]},{column:"F",score:[{value:2},{value:1}],grid:[{color:"yellow"},{color:"yellow"},{color:"green"},{color:"orange",star:!0},{color:"red"},{color:"red"},{color:"blue"}]},{column:"G",score:[{value:2},{value:1}],grid:[{color:"yellow"},{color:"orange"},{color:"green",star:!0},{color:"blue"},{color:"blue"},{color:"red"},{color:"red"}]},{column:"H",score:[{value:1},{value:0}],grid:[{color:"green",star:!0},{color:"orange"},{color:"red"},{color:"blue"},{color:"blue"},{color:"yellow"},{color:"yellow"}]},{column:"I",score:[{value:2},{value:1}],grid:[{color:"blue"},{color:"red"},{color:"red"},{color:"green"},{color:"orange"},{color:"yellow",star:!0},{color:"yellow"}]},{column:"J",score:[{value:2},{value:1}],grid:[{color:"blue"},{color:"blue",star:!0},{color:"red"},{color:"green"},{color:"orange"},{color:"orange"},{color:"yellow"}]},{column:"K",score:[{value:2},{value:1}],grid:[{color:"blue"},{color:"blue"},{color:"yellow"},{color:"yellow"},{color:"orange"},{color:"red",star:!0},{color:"green"}]},{column:"L",score:[{value:2},{value:1}],grid:[{color:"orange",star:!0},{color:"orange"},{color:"yellow"},{color:"yellow"},{color:"red"},{color:"blue"},{color:"green"}]},{column:"M",score:[{value:3},{value:2}],grid:[{color:"yellow"},{color:"orange"},{color:"orange"},{color:"orange"},{color:"red"},{color:"blue"},{color:"green",star:!0}]},{column:"N",score:[{value:3},{value:2}],grid:[{color:"yellow"},{color:"green"},{color:"green"},{color:"red",star:!0},{color:"red"},{color:"blue"},{color:"orange"}]},{column:"O",score:[{value:5},{value:3}],grid:[{color:"yellow"},{color:"green"},{color:"green"},{color:"blue"},{color:"red"},{color:"orange",star:!0},{color:"orange"}]}],p=[{column:"A",score:[{value:5},{value:3}],grid:[{color:"red"},{color:"red"},{color:"blue"},{color:"orange"},{color:"yellow"},{color:"yellow"},{color:"green",star:!0}]},{column:"B",score:[{value:3},{value:2}],grid:[{color:"green"},{color:"green"},{color:"red",star:!0},{color:"orange"},{color:"blue"},{color:"yellow"},{color:"yellow"}]},{column:"C",score:[{value:3},{value:2}],grid:[{color:"green"},{color:"red"},{color:"red"},{color:"orange"},{color:"blue"},{color:"blue",star:!0},{color:"yellow"}]},{column:"D",score:[{value:3},{value:2}],grid:[{color:"yellow",star:!0},{color:"red"},{color:"blue"},{color:"orange"},{color:"orange"},{color:"green"},{color:"green"}]},{column:"E",score:[{value:2},{value:1}],grid:[{color:"yellow"},{color:"red"},{color:"blue"},{color:"blue"},{color:"orange"},{color:"green"},{color:"green",star:!0}]},{column:"F",score:[{value:2},{value:1}],grid:[{color:"yellow"},{color:"yellow"},{color:"green",star:!0},{color:"blue"},{color:"red"},{color:"orange"},{color:"orange"}]},{column:"G",score:[{value:2},{value:1}],grid:[{color:"yellow"},{color:"yellow"},{color:"green"},{color:"blue"},{color:"red"},{color:"orange",star:!0},{color:"orange"}]},{column:"H",score:[{value:1},{value:0}],grid:[{color:"orange"},{color:"orange"},{color:"green"},{color:"blue",star:!0},{color:"red"},{color:"yellow"},{color:"yellow"}]},{column:"I",score:[{value:2},{value:1}],grid:[{color:"red"},{color:"red"},{color:"green"},{color:"green"},{color:"blue"},{color:"yellow"},{color:"orange",star:!0}]},{column:"J",score:[{value:2},{value:1}],grid:[{color:"red"},{color:"red"},{color:"green"},{color:"yellow",star:!0},{color:"blue"},{color:"orange"},{color:"orange"}]},{column:"K",score:[{value:2},{value:1}],grid:[{color:"green"},{color:"green"},{color:"red",star:!0},{color:"yellow"},{color:"blue"},{color:"blue"},{color:"orange"}]},{column:"L",score:[{value:2},{value:1}],grid:[{color:"green"},{color:"green"},{color:"blue"},{color:"blue"},{color:"red",star:!0},{color:"yellow"},{color:"orange"}]},{column:"M",score:[{value:3},{value:2}],grid:[{color:"green"},{color:"blue"},{color:"orange",star:!0},{color:"red"},{color:"red"},{color:"yellow"},{color:"yellow"}]},{column:"N",score:[{value:3},{value:2}],grid:[{color:"blue"},{color:"blue"},{color:"blue",star:!0},{color:"red"},{color:"orange"},{color:"yellow"},{color:"green"}]},{column:"O",score:[{value:5},{value:3}],grid:[{color:"yellow",star:!0},{color:"blue"},{color:"red"},{color:"red"},{color:"orange"},{color:"orange"},{color:"green"}]}],w=[{column:"A",score:[{value:5},{value:3}],grid:[{color:"yellow"},{color:"orange"},{color:"orange"},{color:"orange"},{color:"green"},{color:"blue",star:!0},{color:"red"}]},{column:"B",score:[{value:3},{value:2}],grid:[{color:"yellow"},{color:"blue"},{color:"orange"},{color:"green",star:!0},{color:"green"},{color:"green"},{color:"red"}]},{column:"C",score:[{value:3},{value:2}],grid:[{color:"orange",star:!0},{color:"blue"},{color:"blue"},{color:"yellow"},{color:"green"},{color:"red"},{color:"red"}]},{column:"D",score:[{value:3},{value:2}],grid:[{color:"orange"},{color:"blue"},{color:"blue"},{color:"yellow"},{color:"red",star:!0},{color:"green"},{color:"green"}]},{column:"E",score:[{value:2},{value:1}],grid:[{color:"orange"},{color:"red"},{color:"yellow",star:!0},{color:"yellow"},{color:"yellow"},{color:"green"},{color:"blue"}]},{column:"F",score:[{value:2},{value:1}],grid:[{color:"green",star:!0},{color:"red"},{color:"red"},{color:"yellow"},{color:"orange"},{color:"orange"},{color:"blue"}]},{column:"G",score:[{value:2},{value:1}],grid:[{color:"blue"},{color:"red"},{color:"orange",star:!0},{color:"orange"},{color:"green"},{color:"green"},{color:"yellow"}]},{column:"H",score:[{value:1},{value:0}],grid:[{color:"blue"},{color:"red",star:!0},{color:"orange"},{color:"green"},{color:"green"},{color:"yellow"},{color:"yellow"}]},{column:"I",score:[{value:2},{value:1}],grid:[{color:"blue"},{color:"red"},{color:"orange"},{color:"orange"},{color:"yellow",star:!0},{color:"green"},{color:"green"}]},{column:"J",score:[{value:2},{value:1}],grid:[{color:"yellow"},{color:"yellow"},{color:"blue",star:!0},{color:"blue"},{color:"orange"},{color:"red"},{color:"green"}]},{column:"K",score:[{value:2},{value:1}],grid:[{color:"yellow"},{color:"yellow",star:!0},{color:"blue"},{color:"blue"},{color:"orange"},{color:"red"},{color:"green"}]},{column:"L",score:[{value:2},{value:1}],grid:[{color:"red"},{color:"blue"},{color:"blue"},{color:"orange",star:!0},{color:"orange"},{color:"yellow"},{color:"green"}]},{column:"M",score:[{value:3},{value:2}],grid:[{color:"red"},{color:"red"},{color:"red"},{color:"blue"},{color:"orange"},{color:"yellow"},{color:"green",star:!0}]},{column:"N",score:[{value:3},{value:2}],grid:[{color:"green"},{color:"red",star:!0},{color:"blue"},{color:"blue"},{color:"orange"},{color:"yellow"},{color:"yellow"}]},{column:"O",score:[{value:5},{value:3}],grid:[{color:"green"},{color:"orange"},{color:"blue",star:!0},{color:"red"},{color:"red"},{color:"red"},{color:"yellow"}]}],f=[{column:"A",score:[{value:5},{value:3}],grid:[{color:"orange",star:!0},{color:"blue"},{color:"yellow"},{color:"yellow"},{color:"red"},{color:"green"},{color:"green"}]},{column:"B",score:[{value:3},{value:2}],grid:[{color:"orange"},{color:"orange"},{color:"blue"},{color:"yellow",star:!0},{color:"yellow"},{color:"green"},{color:"red"}]},{column:"C",score:[{value:3},{value:2}],grid:[{color:"yellow",star:!0},{color:"orange"},{color:"blue"},{color:"blue"},{color:"green"},{color:"green"},{color:"red"}]},{column:"D",score:[{value:3},{value:2}],grid:[{color:"orange"},{color:"orange"},{color:"green"},{color:"yellow"},{color:"blue",star:!0},{color:"red"},{color:"red"}]},{column:"E",score:[{value:2},{value:1}],grid:[{color:"red"},{color:"green",star:!0},{color:"green"},{color:"yellow"},{color:"blue"},{color:"blue"},{color:"orange"}]},{column:"F",score:[{value:2},{value:1}],grid:[{color:"red"},{color:"red"},{color:"red"},{color:"yellow"},{color:"green",star:!0},{color:"blue"},{color:"orange"}]},{column:"G",score:[{value:2},{value:1}],grid:[{color:"red",star:!0},{color:"green"},{color:"green"},{color:"yellow"},{color:"yellow"},{color:"blue"},{color:"orange"}]},{column:"H",score:[{value:1},{value:0}],grid:[{color:"green"},{color:"green"},{color:"yellow"},{color:"blue",star:!0},{color:"orange"},{color:"orange"},{color:"red"}]},{column:"I",score:[{value:2},{value:1}],grid:[{color:"orange"},{color:"yellow",star:!0},{color:"yellow"},{color:"blue"},{color:"blue"},{color:"green"},{color:"red"}]},{column:"J",score:[{value:2},{value:1}],grid:[{color:"red",star:!0},{color:"red"},{color:"yellow"},{color:"yellow"},{color:"blue"},{color:"green"},{color:"orange"}]},{column:"K",score:[{value:2},{value:1}],grid:[{color:"green"},{color:"red"},{color:"red"},{color:"yellow"},{color:"blue"},{color:"orange",star:!0},{color:"orange"}]},{column:"L",score:[{value:2},{value:1}],grid:[{color:"green"},{color:"green",star:!0},{color:"red"},{color:"red"},{color:"blue"},{color:"yellow"},{color:"orange"}]},{column:"M",score:[{value:3},{value:2}],grid:[{color:"green"},{color:"blue"},{color:"blue"},{color:"orange"},{color:"orange"},{color:"yellow"},{color:"red",star:!0}]},{column:"N",score:[{value:3},{value:2}],grid:[{color:"green"},{color:"yellow"},{color:"yellow"},{color:"orange"},{color:"blue"},{color:"blue",star:!0},{color:"red"}]},{column:"O",score:[{value:5},{value:3}],grid:[{color:"green"},{color:"yellow"},{color:"orange",star:!0},{color:"orange"},{color:"blue"},{color:"blue"},{color:"red"}]}];class k{selectedLevel=!1;static levelMap={level1:y,level2:p,level3:w,level4:f};constructor(){u(a,(()=>{this.selectedLevel=!1})),u(n,(()=>{o("selectLevelModal")&&m("selectLevelModal")}));let l=localStorage.getItem("kok_level");l&&(this.level=l)}reset(){localStorage.removeItem("kok_level")}select(){if(!1!==this.selectedLevel)return void t(n,{level:this.selectedLevel});let l=this,e="selectLevelModal";var r,c;o(e)?m(e):(b({id:"selectLevelModal",visible:!0,message:!1,body:'\n                <div class="level-image-container">\n                    <a href="#">\n                        <span>Level 1</span>\n                        <img src="/images/level1.png" alt="Level 1" class="level-image" id="level1">\n                    </a>\n                    <a href="#">\n                        <span>Level 2</span>\n                        <img src="/images/level2.png" alt="Level 2" class="level-image" id="level2">\n                    </a>\n                    <a href="#">\n                        <span>Level 3</span>\n                        <img src="/images/level3.png" alt="Level 3" class="level-image" id="level3">\n                    </a>\n                    <a href="#">\n                        <span>Level 4</span>\n                        <img src="/images/level4.png" alt="Level 4" class="level-image" id="level4">\n                    </a>\n                </div>\n            ',buttons:!1}),r=".level-image-container a",c=o=>{o.addEventListener("click",(o=>{o.preventDefault(),l.level=o.target.id}),!1)},Array.prototype.forEach.call(document.querySelectorAll(r),c))}set level(o){localStorage.setItem("kok_level",o),this.selectedLevel=k.levelMap[o],this.notify()}get level(){return this.selectedLevel}notify(){t(n,{level:this.selectedLevel})}}const h=["green","yellow","blue","red","orange"];function L(){return JSON.parse(localStorage.getItem("kok_state"))||function(){let o,l={grid:H.level,jokers:[],colorScores:{high:[],low:[]}};for(o=0;o<8;o++)l.jokers.push({selected:!1});return h.forEach((o=>{l.colorScores.high.push({color:o,value:0}),l.colorScores.low.push({color:o,value:0})})),l}()}function E(o){localStorage.setItem("kok_state",JSON.stringify(o))}function S(o,l,e){let r=!1,c=L();c.colorScores[o].forEach((o=>{o.color===l&&(o.value=e,r=!0)})),r&&(E(c),q(c))}function T(){let o=document.querySelectorAll(".score-block:not(.final-score)");Array.prototype.forEach.call(o,(o=>{o.addEventListener("click",(()=>{let l=!o.classList.contains("selected");!function(o,l,e,r){let c=L(),a=!1;c.grid.forEach(((n,s)=>{n.column===o&&(c.grid[s].grid[l][e]=r,a=!0)})),a&&E(c),q(c)}(o.data.column,o.data.row,"selected",l),I()}),!1)}));let l=function(o,l=5,e=-1){return o.classList.contains("final-selected")||o.classList.contains("selected")?o.classList.contains("final-selected")&&!o.classList.contains("selected")?e:0:l},e=function(o){let l="";return h.forEach((e=>{o.classList.contains(e)&&(l=e)})),l},r=document.querySelectorAll("#scoreColumn1 .final-score");Array.prototype.forEach.call(r,(o=>{o.addEventListener("click",(()=>{S("high",e(o),l(o,5,-1)),N()}),!1)}));let c=document.querySelectorAll("#scoreColumn2 .final-score");Array.prototype.forEach.call(c,(o=>{o.addEventListener("click",(()=>{S("low",e(o),l(o,3,-1)),N()}),!1)}));let a=document.querySelectorAll("span.column-score");Array.prototype.forEach.call(a,(o=>{o.addEventListener("click",(()=>{let l,e=o.data.column,r=o.data.row;l=o.classList.contains("active")||o.classList.contains("taken")?o.classList.contains("active")&&!o.classList.contains("taken")?"taken":"default":"active",function(o,l,e,r,c="grid"){let a=L(),n=!1;a.grid.forEach(((s,t)=>{s.column===o&&(a.grid[t][c][l][e]=r,n=!0)})),n&&E(a),q(a)}(e,r,"state",l,"score"),j()}),!1)}));let n=document.getElementsByClassName("joker");Array.prototype.forEach.call(n,((o,l)=>{o.addEventListener("click",(()=>{let e=!o.classList.contains("used");!function(o,l){let e=L(),r=!1;e.jokers.forEach(((e,c)=>{c===o&&(e.selected=l,r=!0)})),r&&(E(e),q(e))}(l,e),C()}),!1)}))}function M(){let l=o("totalScore");l.classList.contains("hide")?(l.innerText=A()+G()+$()-x(),l.classList.remove("hide")):(l.innerText="",l.classList.add("hide"))}function A(){let o=document.querySelectorAll(".final-selected span"),l=0;return Array.prototype.forEach.call(o,(o=>{l+=parseInt(o.innerText)})),l}function N(){o("bonusTotal").innerText=A()}function $(){let o=document.getElementsByClassName("joker"),l=o.length,e=0;return Array.prototype.forEach.call(o,(o=>{o.classList.contains("used")&&e++})),1*(l-e)}function C(){o("jokerTotal").innerText=$()}function G(){let o=document.querySelectorAll("span.column-score.active"),l=0;return Array.prototype.forEach.call(o,(o=>{let e=parseInt(o.innerText);l+=e})),l}function j(){o("columnsTotal").innerText=G()}function x(){let o=document.querySelectorAll("span.selected span.star").length;return 2*(document.querySelectorAll("span.star").length-o)}function I(){o("starsTotal").innerText=x()}function q(l){void 0===l&&(l=L()),o("blockGrid").innerHTML="",l.grid.forEach((l=>{o("blockGrid").append(function(o){let l=i("div",{className:"column"+("H"===o.column?" highlight":"")});i("span",{className:"letter rounded-block",innerText:o.column},l),o.grid.forEach(((e,r)=>{const c=i("span",{className:"score-block "+e.color,data:{column:o.column,row:r}});e.star&&i("span",{className:"star",innerText:"*"},c),e.selected&&c.classList.add("selected"),l.append(c)}));let e=i("div",{className:"column-score"});return o.score.forEach(((l,r)=>{i("span",{className:"rounded-block column-score"+(l.state&&"default"!==l.state?" "+l.state:""),innerText:l.value,data:{column:o.column,row:r}},e)})),l.append(e),l}(l))}));let e=o("jokerContainer");e.innerHTML="",l.jokers.forEach((o=>{let l=i("span",{className:"joker",innerText:"!"});o.selected&&l.classList.add("used"),e.append(l)})),o("scoreColumn1").innerHTML="",l.colorScores.high.forEach((l=>{let e=i("span",{className:"score-block final-score "+l.color});-1===l.value&&e.classList.add("selected"),5===l.value&&e.classList.add("final-selected"),i("span",{innerText:5},e),o("scoreColumn1").append(e)})),o("scoreColumn2").innerHTML="",l.colorScores.low.forEach((l=>{let e=i("span",{className:"score-block final-score "+l.color});-1===l.value&&e.classList.add("selected"),3===l.value&&e.classList.add("final-selected"),i("span",{innerText:3},e),o("scoreColumn2").append(e)})),function(){if(o("totalScores"))return;const l=`\n    <div id="totalScores">\n        <div class="totals" id="bonus"><label>${d.label.bonus}</label><span class="label">=</span><span id="bonusTotal" class="totalValue">15</span></div>\n        <div class="totals" id="columns"><label>${d.label.columns}</label><span class="label">+</span><span id="columnsTotal" class="totalValue"></span></div>\n        <div class="totals" id="jokers"><label>${d.label.jokers}</label><span class="label">+</span><span id="jokerTotal" class="totalValue"></span></div>\n        <div class="totals" id="stars"><label>${d.label.stars}</label><span class="label">-</span><span id="starsTotal" class="totalValue"></span></div>\n        <div class="totals" id="totals">\n            <label>${d.label.totals}</label><span class="label">&nbsp;</span><span id="totalScore" class="totalValue hide"></span>\n        </div>\n    </div>\n    `;o("scoreColumn").append(g(l)),o("totals").addEventListener("click",(()=>{t(s)}),!1)}(),v(),T(),N(),C(),j(),I()}const H=new k;u(e,(()=>{localStorage.removeItem("kok_state"),H.reset(),t(r)})),u(r,(()=>{t(c)})),u(c,(()=>{H.select()})),u(n,(()=>{q(L())})),u(s,(()=>{M()})),t(c),b({id:"orientationModal",message:d.notification.landscapeMode});
